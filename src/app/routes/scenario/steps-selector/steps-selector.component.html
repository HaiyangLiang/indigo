<div nz-row nzType="flex" nzJustify="start" [nzGutter]="3">
  <div nz-col nzSpan="24" style="border:1px solid lightgray;border-radius:5px;">
    <nz-divider style="margin-top:5px;" [nzText]="nzText" nzOrientation="left">
      <ng-template #nzText>
        <span style="font-size:small;color:darkgray;">{{'field-steps'|translate}}</span>
      </ng-template>
    </nz-divider>
    <div [sortablejs]="steps" [sortablejsOptions]="sortablejsOptions">
      <div class="step" style="width:100%;margin-left:10px;margin-top:6px;margin-right:10px;"
        *ngFor="let item of steps;let i = index;">
        <div [ngSwitch]="item.type">
          <ng-container *ngSwitchCase="'case'">
            <span><i nz-icon type="bars" theme="outline" class="click-icon" style="cursor:grab"></i></span>
            <a style="padding-left:4px;" (click)="removeStep(item, i)">
              <i nz-icon type="close-circle" theme="outline" class="click-icon hover-red"></i>
            </a>
            <span> {{i+1}}. </span>
            <span class="step-title" (click)="viewStep(item)">
              <span class="small-text">{{getStepData(item).summary}}</span>
            </span>
            <ng-container *ngIf="item.labels">
              <span style="float:right;transform:scale(0.8);">
                <nz-tag *ngFor="let item of getStepData(item).labels">{{getStepData(item).name}}</nz-tag>
              </span>
            </ng-container>
            <div>
              <nz-badge [nzStatus]="getStepStatus(item).status"></nz-badge>
              <label class="check" nz-checkbox nz-tooltip [nzTitle]="'tips-step-checkbox'|translate"
                [(ngModel)]="item.stored"></label>
              <nz-tag [nzColor]="methodTagColor(item)">{{getStepData(item).request.method}}</nz-tag>
              <span class="small-text">{{getStepData(item).request.urlPath}}</span>
            </div>
          </ng-container>
          <ng-container *ngSwitchCase="'dubbo'">
            <span><i nz-icon type="bars" theme="outline" class="click-icon" style="cursor:grab"></i></span>
            <a style="padding-left:4px;" (click)="removeStep(item, i)">
              <i nz-icon type="close-circle" theme="outline" class="click-icon hover-red"></i>
            </a>
            <span> {{i+1}}. </span>
            <span class="step-title" (click)="viewStep(item)">
              <span class="small-text">{{getStepData(item).summary}}</span>
            </span>
            <ng-container *ngIf="item.labels">
              <span style="float:right;transform:scale(0.8);">
                <nz-tag *ngFor="let item of getStepData(item).labels">{{getStepData(item).name}}</nz-tag>
              </span>
            </ng-container>
            <div>
              <nz-badge [nzStatus]="getStepStatus(item).status"></nz-badge>
              <label class="check" nz-checkbox nz-tooltip [nzTitle]="'tips-step-checkbox'|translate"
                [(ngModel)]="item.stored"></label>
              <nz-tag [nzColor]="'gold'">
                <i nz-icon nzType="alibaba" nzTheme="outline"></i>
                <span> dubbo</span>
              </nz-tag>
              <span class="small-text">{{getDubboRequestSignature(item)}}</span>
            </div>
          </ng-container>
          <ng-container *ngSwitchCase="'sql'">
            <span><i nz-icon type="bars" theme="outline" class="click-icon" style="cursor:grab"></i></span>
            <a style="padding-left:4px;" (click)="removeStep(item, i)">
              <i nz-icon type="close-circle" theme="outline" class="click-icon hover-red"></i>
            </a>
            <span> {{i+1}}. </span>
            <span class="step-title" (click)="viewStep(item)">
              <span class="small-text">{{getStepData(item).summary}}</span>
            </span>
            <ng-container *ngIf="item.labels">
              <span style="float:right;transform:scale(0.8);">
                <nz-tag *ngFor="let item of getStepData(item).labels">{{getStepData(item).name}}</nz-tag>
              </span>
            </ng-container>
            <div>
              <nz-badge [nzStatus]="getStepStatus(item).status"></nz-badge>
              <label class="check" nz-checkbox nz-tooltip [nzTitle]="'tips-step-checkbox'|translate"
                [(ngModel)]="item.stored"></label>
              <nz-tag [nzColor]="'geekblue'">
                <i nz-icon nzType="database" nzTheme="outline"></i>
                <span> sql</span>
              </nz-tag>
              <span class="small-text">{{getSqlRequestSignature(item)}}</span>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
    <div nz-row style="padding:16px;">
      <button nz-button nzSize="small" nzType="dashed" (click)="selectStep()">
        <span style="margin-left:2px;">{{'btn-add-req'|translate}}</span>
      </button>
      <nz-dropdown-button style="margin-left:4px;" nzSize="small" nzType="dashed" (nzClick)="addNewHttpStep()">
        <span>
          <span><i nz-icon type="plus" theme="outline"></i></span>
          <span style="margin-left:2px;">{{'btn-add-new-req'|translate}}</span>
        </span>
        <ul nz-menu>
          <li nz-menu-item (click)="addNewDubboStep()">dubbo</li>
          <li nz-menu-item (click)="addNewSqlStep()">sql</li>
        </ul>
      </nz-dropdown-button>
    </div>
  </div>
</div>
<!-- select steps drawer -->
<nz-drawer [nzVisible]="stepListDrawerVisible" [nzWidth]="stepListDrawerWidth" [nzBodyStyle]="{'padding':'4px'}"
  [nzClosable]="false" (nzOnClose)="stepListDrawerVisible=false">
  <app-select-step *ngIf="stepListDrawerSwitch" [group]="group" [project]="project" [onSelectSubject]="onSelectSubject"
    [onUpdateSubject]="onUpdateSubject" [ctxOptions]="_ctxOptions">
  </app-select-step>
</nz-drawer>
